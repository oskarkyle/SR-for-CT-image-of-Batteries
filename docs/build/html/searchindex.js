Search.setIndex({"docnames": ["data", "index", "model", "plot", "pred", "train", "usage"], "filenames": ["data.rst", "index.rst", "model.rst", "plot.rst", "pred.rst", "train.rst", "usage.rst"], "titles": ["Data", "Welcome to SR for CT images of Batteries with Deep Learning\u2019s documentation!", "Model", "Plot neural networks", "Prediction", "Train", "Usage"], "terms": {"The": [0, 1, 2, 6], "can": [0, 3, 6], "from": [0, 1, 2, 4, 5, 6], "follow": [0, 2, 3, 6], "link": 0, "http": [0, 1], "www": 0, "research": 0, "collect": 0, "ethz": 0, "ch": 0, "handl": 0, "20": 0, "500": 0, "11850": 0, "505938": 0, "And": [0, 4], "i": [0, 1, 2, 4, 5, 6], "unzip": 0, "folder": [0, 6], "If": [0, 2], "pleas": 0, "creat": [0, 5], "one": [0, 2, 4], "mkdir": 0, "To": [0, 2, 3, 4, 5, 6], "get": [0, 2, 4], "model": [0, 1, 4, 5, 6], "you": [0, 6], "us": [0, 2, 3, 4, 5, 6], "basedataset": 0, "class": [0, 2], "sourc": 0, "task": 0, "mode": 0, "tile_s": 0, "tile_grid": 0, "dataset_dir": 0, "list": [0, 2, 4], "str": [0, 2], "data_root": 0, "transforms_cfg": 0, "dictconfig": [0, 2, 4, 5], "none": [0, 5], "preprocess_cfg": 0, "base": [0, 1, 2, 6], "check_dataset_constrain": 0, "check": 0, "whether": [0, 2], "meet": 0, "constrain": 0, "get_item_posit": 0, "idx": 0, "each": [0, 2, 4, 6], "tile": [0, 4, 5], "": 0, "inform": [0, 5], "includ": 0, "which": [0, 2, 4], "tif": 0, "file": [0, 2, 4, 5, 6], "belong": 0, "page": [0, 1], "grid": 0, "paramet": [0, 4, 5, 6], "index": [0, 1, 2], "return": [0, 2, 4, 5], "tifffile_index": 0, "page_index": 0, "sequence_number_of_tile_in_pag": 0, "sequenc": [0, 2], "number": [0, 2], "tiling_grid_info": 0, "tupl": [0, 2], "int": [0, 2, 4], "get_pages_count_in_til": 0, "tiff_fil": 0, "total": 0, "path": [0, 2], "num_pag": 0, "static": 0, "get_preprocessor": 0, "preprocessor": 0, "object": 0, "provid": 0, "configur": [0, 1, 2], "arg": [0, 2], "A": [0, 2], "specifi": 0, "detail": 0, "pipelin": 0, "note": 0, "thi": [0, 1, 2, 3, 4, 6], "method": [0, 2], "e": 0, "get_tile_from_index": 0, "tensor": [0, 2, 4], "get_tiles_count_in_each_tiff": 0, "tiles_count_in_each_tiff": 0, "get_tiling_grid_in_each_tiff": 0, "get_transform": 0, "load_file_paths_from_dir": 0, "recurs": 0, "bool": [0, 2], "true": [0, 2], "load": [0, 4], "all": 0, "given": [0, 2], "directori": [0, 2], "root": 0, "ar": 0, "rel": 0, "option": [0, 2], "subdirectori": 0, "default": [0, 2], "sort": 0, "found": 0, "rais": [0, 2], "filenotfounderror": 0, "ani": 0, "bin": 0, "imag": [0, 2, 4], "binning_factor": 0, "we": [0, 3, 4], "first": [0, 2], "downsampl": [0, 2], "factor": [0, 2], "averag": [0, 4], "pool": [0, 2], "upsampl": [0, 2], "origin": 0, "size": [0, 2, 4], "nearest": 0, "neighbor": 0, "interpol": 0, "torch": [0, 2, 4], "input": [0, 2, 4], "convert_dtyp": 0, "convert": [0, 4], "right": 0, "dytp": 0, "param": [0, 5], "gamma_correct": 0, "normal": [0, 2], "mean": 0, "std": 0, "standard": 0, "deviat": 0, "valu": 0, "rescal": 0, "min_val": 0, "max_val": 0, "resiz": 0, "pad": 0, "while": 0, "zero": 0, "make": 0, "squar": 0, "kornia": 0, "librari": 0, "desir": 0, "output": [0, 2, 4], "to_grayscal": 0, "grayscal": 0, "appli": [0, 2, 4], "set": [0, 4], "custom": [0, 5], "exampl": [0, 2, 5, 6], "transform_dict": 0, "rotat": 0, "angl": 0, "30": 0, "adjust_bright": 0, "brightness_factor": 0, "0": [0, 2], "5": 0, "randomaffin": 0, "degre": 0, "float": [0, 2, 4], "etc": 0, "randombright": 0, "adjust": 0, "bright": 0, "must": 0, "posit": 0, "randomcontrast": 0, "contrast": 0, "contrast_factor": 0, "randomcrop": 0, "crop": 0, "random": 0, "locat": [0, 6], "output_s": 0, "expect": 0, "height": 0, "width": 0, "randomgaussianblur": 0, "gaussian": 0, "blur": 0, "kernel_size_rang": 0, "rang": 0, "kernel": [0, 2], "randomli": 0, "sampl": [0, 2], "sigma_rang": 0, "sigma": 0, "randomgaussiannois": 0, "add": 0, "nois": 0, "out": 0, "clip": 0, "distribut": 0, "randomhorizontalflip": 0, "horizont": 0, "flip": 0, "randomhu": 0, "hue": 0, "hue_factor": 0, "randommedianblur": 0, "median": 0, "randomsatur": 0, "satur": 0, "saturation_factor": 0, "randomverticalflip": 0, "vertic": 0, "project": [1, 2, 3, 6], "about": 1, "super": 1, "resolut": 1, "goal": 1, "improv": 1, "unet": [1, 2], "paper": 1, "u": [1, 2], "net": [1, 2], "convolut": [1, 2], "network": 1, "biomed": 1, "segment": 1, "arxiv": 1, "org": 1, "ab": 1, "1505": 1, "04597": 1, "train": [1, 2, 4, 6], "dataset": [1, 4, 6], "multimod": 1, "nanoscal": 1, "tomograph": 1, "electrod": 1, "doi": 1, "10": [1, 6], "1002": 1, "aenm": 1, "201904119": 1, "usag": 1, "instal": 1, "depand": 1, "start": [1, 2, 4, 5], "data": [1, 4], "download": 1, "preprocess": [1, 4], "transform": [1, 4], "convblock": 1, "skipconnect": 1, "combineconnect": 1, "convunet": [1, 4, 5], "predict": [1, 2], "plot": [1, 4], "neural": 1, "modul": [1, 2], "search": 1, "contain": [2, 6], "implement": 2, "In": [2, 4, 6], "subsect": 2, "build": 2, "block": 2, "in_channel": 2, "out_channel": 2, "n_layer": 2, "2": 2, "scale_factor": 2, "kernel_s": 2, "3": [2, 6], "n_group": 2, "32": 2, "layer": 2, "max": 2, "group": 2, "activ": 2, "function": [2, 4, 5], "channel": 2, "forward": 2, "x": 2, "skip": 2, "connect": 2, "perform": 2, "intermedi": 2, "pass": 2, "combin": 2, "residu": 2, "between": 2, "dropout": 2, "probabl": 2, "x_e": 2, "element": 2, "wise": 2, "addit": 2, "two": 2, "same": 2, "spatial": 2, "dimens": 2, "model_cfg": 2, "image_channel": 2, "1": 2, "output_channel": 2, "c_factor": 2, "6": 2, "ch_mult": 2, "4": 2, "n_block": 2, "verbos": 2, "lightningmodul": 2, "simpl": [2, 6], "conv": 2, "dictionari": 2, "union": 2, "multipli": 2, "scale": 2, "groupnorm": 2, "print": 2, "log": [2, 4, 5], "attribut": 2, "image_proj": 2, "nn": 2, "conv2d": 2, "down": 2, "modulelist": 2, "middl": 2, "up": [2, 4], "norm": 2, "act": 2, "swish": 2, "final": 2, "sig": 2, "sigmoid": 2, "configure_optim": 2, "optim": 2, "schedul": 2, "learn": 2, "rate": 2, "lightn": 2, "depend": 2, "an": [2, 5, 6], "second": 2, "defin": 2, "It": 2, "take": 2, "through": 2, "produc": 2, "save": [2, 4], "h": 2, "later": 2, "after": 2, "them": 2, "result": 2, "get_loss": 2, "y_hat": 2, "y": 2, "loss": [2, 4], "current": 2, "step": 2, "predict_step": 2, "batch": [2, 5], "batch_idx": 2, "dataloader_idx": 2, "dataload": [2, 5], "classmethod": 2, "restor": 2, "ckpt": 2, "map_loc": 2, "devic": 2, "mp": 2, "pytorch": 2, "checkpoint": [2, 4], "cl": 2, "map": 2, "its": 2, "runtimeerror": 2, "doe": 2, "hyperparamet": 2, "plmodel": 2, "config": [2, 5, 6], "save_model": 2, "model_nam": 2, "save_dir": 2, "test_model": 2, "input_data": 2, "training_step": 2, "validation_step": 2, "valid": [2, 4], "visual": [3, 5], "differ": [3, 6], "depth": 3, "command": [3, 6], "cd": 3, "pyexampl": 3, "tikzmak": 3, "sh": 3, "section": [4, 6], "introduc": 4, "how": 4, "here": [4, 5, 6], "pred": [4, 6], "test_slic": 4, "cfg": [4, 5], "specif": [4, 6], "slice": 4, "test": 4, "order": 4, "label": 4, "setup_test_set": 4, "split": [4, 6], "ratio": [4, 6], "test_set": 4, "util": 4, "setup_input_label": 4, "thesi": 4, "load_model": 4, "reassembl": 4, "reassembled_imag": 4, "infer": [4, 6], "calc_average_psnr_in_testset": 4, "calcul": 4, "psnr": 4, "average_psnr": 4, "convert_iter_to_epoch": 4, "epoch_s": 4, "curv": 4, "want": 4, "show": 4, "epoch": [4, 6], "But": 4, "iter": 4, "so": 4, "need": 4, "get_train_loss_val_loss": 4, "csv": 4, "train_loss_valu": 4, "val_loss_valu": 4, "val_it": 4, "plot_loss_in_it": 4, "plot_loss_in_epoch": 4, "custom_col": 5, "collat": 5, "drop": 5, "edg": 5, "prevent": 5, "pollut": 5, "init_model": 5, "setup_dataload": 5, "train_dataload": 5, "validation_dataload": 5, "test_dataload": 5, "setup_logg": 5, "process": 5, "logger": 5, "tensorboardlogg": 5, "start_train": 5, "guid": 6, "python": 6, "11": 6, "pip": 6, "r": 6, "requir": 6, "txt": 6, "run": 6, "code": 6, "main": 6, "py": 6, "store": 6, "yaml": 6, "divid": 6, "part": 6, "split_ratio": 6, "chang": 6, "behavior": 6, "50": 6}, "objects": {"model.unet.ConvUNet": [[2, 0, 1, "", "ConvUNet"]], "model.unet.ConvUNet.ConvUNet": [[2, 1, 1, "", "configure_optimizers"], [2, 1, 1, "", "forward"], [2, 1, 1, "", "get_loss"], [2, 1, 1, "", "predict_step"], [2, 1, 1, "", "restore"], [2, 1, 1, "", "save_model"], [2, 1, 1, "", "test_model"], [2, 1, 1, "", "training_step"], [2, 1, 1, "", "validation_step"]], "model.unet.blocks": [[2, 0, 1, "", "CombineConnection"], [2, 0, 1, "", "ConvBlock"], [2, 0, 1, "", "SkipConnection"]], "model.unet.blocks.CombineConnection": [[2, 1, 1, "", "forward"]], "model.unet.blocks.ConvBlock": [[2, 1, 1, "", "forward"]], "model.unet.blocks.SkipConnection": [[2, 1, 1, "", "forward"]], "pred": [[4, 2, 1, "", "calc_average_psnr_in_testset"], [4, 2, 1, "", "convert_iter_to_epoch"], [4, 2, 1, "", "get_train_loss_val_loss"], [4, 2, 1, "", "inference"], [4, 2, 1, "", "load_model"], [4, 2, 1, "", "plot_loss_in_epoch"], [4, 2, 1, "", "plot_loss_in_iter"], [4, 2, 1, "", "prediction"], [4, 2, 1, "", "reassemble"], [4, 2, 1, "", "setup_input_label"], [4, 2, 1, "", "setup_test_set"], [4, 2, 1, "", "splitting"], [4, 2, 1, "", "test_slice"]], "preprocess.Preprocessor": [[0, 0, 1, "", "Preprocessor"]], "preprocess.Preprocessor.Preprocessor": [[0, 1, 1, "", "binning"], [0, 1, 1, "", "convert_dtype"], [0, 1, 1, "", "gamma_correction"], [0, 1, 1, "", "normalize"], [0, 1, 1, "", "rescale"], [0, 1, 1, "", "resize"], [0, 1, 1, "", "to_grayscale"]], "source.BaseDataset": [[0, 0, 1, "", "BaseDataset"]], "source.BaseDataset.BaseDataset": [[0, 1, 1, "", "check_dataset_constrains"], [0, 1, 1, "", "get_item_position"], [0, 1, 1, "", "get_pages_count_in_tile"], [0, 1, 1, "", "get_preprocessor"], [0, 1, 1, "", "get_tile_from_index"], [0, 1, 1, "", "get_tiles_count_in_each_tiff"], [0, 1, 1, "", "get_tiling_grid_in_each_tiff"], [0, 1, 1, "", "get_transforms"], [0, 1, 1, "", "load_file_paths_from_dir"]], "train": [[5, 2, 1, "", "custom_collate"], [5, 2, 1, "", "init_model"], [5, 2, 1, "", "setup_dataloaders"], [5, 2, 1, "", "setup_logger"], [5, 2, 1, "", "start_training"]], "transform.Transforms": [[0, 0, 1, "", "Transforms"]], "transform.Transforms.Transforms": [[0, 1, 1, "", "RandomAffine"], [0, 1, 1, "", "RandomBrightness"], [0, 1, 1, "", "RandomContrast"], [0, 1, 1, "", "RandomCrop"], [0, 1, 1, "", "RandomGaussianBlur"], [0, 1, 1, "", "RandomGaussianNoise"], [0, 1, 1, "", "RandomHorizontalFlip"], [0, 1, 1, "", "RandomHue"], [0, 1, 1, "", "RandomMedianBlur"], [0, 1, 1, "", "RandomSaturation"], [0, 1, 1, "", "RandomVerticalFlip"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"]}, "titleterms": {"data": 0, "download": 0, "dataset": 0, "preprocess": 0, "transform": 0, "welcom": 1, "sr": 1, "ct": 1, "imag": 1, "batteri": 1, "deep": 1, "learn": 1, "": 1, "document": 1, "content": 1, "indic": 1, "tabl": 1, "model": 2, "convblock": 2, "skipconnect": 2, "combineconnect": 2, "convunet": [2, 3], "plot": 3, "neural": 3, "network": 3, "predict": 4, "configur": [4, 5, 6], "train": 5, "usag": 6, "instal": 6, "depand": 6, "start": 6}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Data": [[0, "data"]], "Download": [[0, "download"]], "Dataset": [[0, "dataset"]], "Preprocessing": [[0, "preprocessing"]], "Transform": [[0, "transform"]], "Welcome to SR for CT images of Batteries with Deep Learning\u2019s documentation!": [[1, "welcome-to-sr-for-ct-images-of-batteries-with-deep-learning-s-documentation"]], "Contents:": [[1, null]], "Indices and tables": [[1, "indices-and-tables"]], "Model": [[2, "model"]], "ConvBlock": [[2, "convblock"]], "SkipConnection": [[2, "skipconnection"]], "CombineConnection": [[2, "combineconnection"]], "ConvUNet": [[2, "convunet"], [3, "convunet"]], "Plot neural networks": [[3, "plot-neural-networks"]], "Prediction": [[4, "prediction"]], "Predicting configuration": [[4, "predicting-configuration"]], "Train": [[5, "train"]], "Training configuration": [[5, "training-configuration"]], "Usage": [[6, "usage"]], "Installation and depandencies": [[6, "installation-and-depandencies"]], "Start": [[6, "start"]], "Configuration": [[6, "configuration"]]}, "indexentries": {"basedataset (class in source.basedataset)": [[0, "source.BaseDataset.BaseDataset"]], "preprocessor (class in preprocess.preprocessor)": [[0, "preprocess.Preprocessor.Preprocessor"]], "randomaffine() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomAffine"]], "randombrightness() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomBrightness"]], "randomcontrast() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomContrast"]], "randomcrop() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomCrop"]], "randomgaussianblur() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomGaussianBlur"]], "randomgaussiannoise() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomGaussianNoise"]], "randomhorizontalflip() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomHorizontalFlip"]], "randomhue() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomHue"]], "randommedianblur() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomMedianBlur"]], "randomsaturation() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomSaturation"]], "randomverticalflip() (transform.transforms.transforms static method)": [[0, "transform.Transforms.Transforms.RandomVerticalFlip"]], "transforms (class in transform.transforms)": [[0, "transform.Transforms.Transforms"]], "binning() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.binning"]], "check_dataset_constrains() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.check_dataset_constrains"]], "convert_dtype() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.convert_dtype"]], "gamma_correction() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.gamma_correction"]], "get_item_position() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.get_item_position"]], "get_pages_count_in_tile() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.get_pages_count_in_tile"]], "get_preprocessor() (source.basedataset.basedataset static method)": [[0, "source.BaseDataset.BaseDataset.get_preprocessor"]], "get_tile_from_index() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.get_tile_from_index"]], "get_tiles_count_in_each_tiff() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.get_tiles_count_in_each_tiff"]], "get_tiling_grid_in_each_tiff() (source.basedataset.basedataset method)": [[0, "source.BaseDataset.BaseDataset.get_tiling_grid_in_each_tiff"]], "get_transforms() (source.basedataset.basedataset static method)": [[0, "source.BaseDataset.BaseDataset.get_transforms"]], "load_file_paths_from_dir() (source.basedataset.basedataset static method)": [[0, "source.BaseDataset.BaseDataset.load_file_paths_from_dir"]], "normalize() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.normalize"]], "rescale() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.rescale"]], "resize() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.resize"]], "to_grayscale() (preprocess.preprocessor.preprocessor static method)": [[0, "preprocess.Preprocessor.Preprocessor.to_grayscale"]], "combineconnection (class in model.unet.blocks)": [[2, "model.unet.blocks.CombineConnection"]], "convblock (class in model.unet.blocks)": [[2, "model.unet.blocks.ConvBlock"]], "convunet (class in model.unet.convunet)": [[2, "model.unet.ConvUNet.ConvUNet"]], "skipconnection (class in model.unet.blocks)": [[2, "model.unet.blocks.SkipConnection"]], "configure_optimizers() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.configure_optimizers"]], "forward() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.forward"]], "forward() (model.unet.blocks.combineconnection method)": [[2, "model.unet.blocks.CombineConnection.forward"]], "forward() (model.unet.blocks.convblock method)": [[2, "model.unet.blocks.ConvBlock.forward"]], "forward() (model.unet.blocks.skipconnection method)": [[2, "model.unet.blocks.SkipConnection.forward"]], "get_loss() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.get_loss"]], "predict_step() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.predict_step"]], "restore() (model.unet.convunet.convunet class method)": [[2, "model.unet.ConvUNet.ConvUNet.restore"]], "save_model() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.save_model"]], "test_model() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.test_model"]], "training_step() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.training_step"]], "validation_step() (model.unet.convunet.convunet method)": [[2, "model.unet.ConvUNet.ConvUNet.validation_step"]], "calc_average_psnr_in_testset() (in module pred)": [[4, "pred.calc_average_psnr_in_testset"]], "convert_iter_to_epoch() (in module pred)": [[4, "pred.convert_iter_to_epoch"]], "get_train_loss_val_loss() (in module pred)": [[4, "pred.get_train_loss_val_loss"]], "inference() (in module pred)": [[4, "pred.inference"]], "load_model() (in module pred)": [[4, "pred.load_model"]], "plot_loss_in_epoch() (in module pred)": [[4, "pred.plot_loss_in_epoch"]], "plot_loss_in_iter() (in module pred)": [[4, "pred.plot_loss_in_iter"]], "prediction() (in module pred)": [[4, "pred.prediction"]], "reassemble() (in module pred)": [[4, "pred.reassemble"]], "setup_input_label() (in module pred)": [[4, "pred.setup_input_label"]], "setup_test_set() (in module pred)": [[4, "pred.setup_test_set"]], "splitting() (in module pred)": [[4, "pred.splitting"]], "test_slice() (in module pred)": [[4, "pred.test_slice"]], "custom_collate() (in module train)": [[5, "train.custom_collate"]], "init_model() (in module train)": [[5, "train.init_model"]], "setup_dataloaders() (in module train)": [[5, "train.setup_dataloaders"]], "setup_logger() (in module train)": [[5, "train.setup_logger"]], "start_training() (in module train)": [[5, "train.start_training"]]}})